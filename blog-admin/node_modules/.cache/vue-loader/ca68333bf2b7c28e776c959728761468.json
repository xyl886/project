{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\src\\views\\news\\message.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\src\\views\\news\\message.vue","mtime":1686703465000},{"path":"C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1689641835446},{"path":"C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1689641839258},{"path":"C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1689641835446},{"path":"C:\\Users\\Administrator\\Desktop\\product\\blog-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1689641841369}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZldGNoTWVzc2FnZSwgcGFzc0JhdGNoLCBkZWxldGVCYXRjaCwgcmVtb3ZlIH0gZnJvbSAnQC9hcGkvbWVzc2FnZScKaW1wb3J0IHsgcGFyc2VUaW1lIH0gZnJvbSAnQC91dGlscycKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnCmltcG9ydCB7IGhhc0F1dGggfSBmcm9tICdAL3V0aWxzL2F1dGgnCgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIG11bHRpcGxlU2VsZWN0aW9uOiBbXSwKICAgICAgLy8g5Yqg6L295bGC5L+h5oGvCiAgICAgIGxvYWRpbmc6IFtdLAogICAgICB0b3RhbDogMCwKICAgICAgc2hvd1NlYXJjaDogdHJ1ZSwKICAgICAgcGFyYW1zOiB7CiAgICAgICAgbmFtZTogbnVsbCwKICAgICAgICBwYWdlTm86IDEsCiAgICAgICAgcGFnZVNpemU6IDEwCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsKICAgICAgJ3ByZXMnCiAgICBdKSwKICAgIGNhbkRlbDogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBoYXNBdXRoKHRoaXMucHJlcywgJy9zeXN0ZW0vbWVzc2FnZS9yZW1vdmUnKQogICAgfSwKICAgIGNhbkRlbEJhdGNoOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGhhc0F1dGgodGhpcy5wcmVzLCAnL3N5c3RlbS9tZXNzYWdlL2RlbGV0ZUJhdGNoJykKICAgIH0sCiAgICBjYW5QYXNzQmF0Y2g6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gaGFzQXV0aCh0aGlzLnByZXMsICcvc3lzdGVtL21lc3NhZ2UvcGFzc0JhdGNoJykKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5vcGVuTG9hZGluZygpCiAgICB0aGlzLmZldGNoTWVzc2FnZSgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBmZXRjaE1lc3NhZ2U6IGZ1bmN0aW9uKCkgewogICAgICBmZXRjaE1lc3NhZ2UodGhpcy5wYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLnJlY29yZHMKICAgICAgICB0aGlzLnRvdGFsID0gcmVzLmRhdGEudG90YWwKICAgICAgICB0aGlzLmxvYWRpbmcuY2xvc2UoKQogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgfSkKICAgIH0sCiAgICByZXNldFF1ZXJ5OiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5wYXJhbXMubmFtZSA9IG51bGwKICAgICAgdGhpcy5wYXJhbXMucGFnZU5vID0gMQogICAgICB0aGlzLmZldGNoTWVzc2FnZSgpCiAgICB9LAogICAgaGFuZGxlRmluZDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucGFyYW1zLnBhZ2VObyA9IDEKICAgICAgdGhpcy5mZXRjaE1lc3NhZ2UoKQogICAgfSwKICAgIGhhbmRsZVBhc3NCYXRjaDogZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgY29uc3QgaWRzID0gW10KICAgICAgaWYgKHNjb3BlICE9IG51bGwpIHsKICAgICAgICBpZHMucHVzaChzY29wZS5yb3cuaWQpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbi5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgaWRzLnB1c2goaXRlbS5pZCkKICAgICAgICB9KQogICAgICB9CiAgICAgIHBhc3NCYXRjaChpZHMpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ09LJykKICAgICAgICB0aGlzLmZldGNoTWVzc2FnZSgpCiAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpCiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlRGVsZXRlQmF0Y2g6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLiRjb25maXJtKCfmraTmk43kvZzlsIbmsLjkuYXliKDpmaTor6XorrDlvZUsIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgY29uc3QgaWRzID0gW10KICAgICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICBpZHMucHVzaChpdGVtLmlkKQogICAgICAgIH0pCiAgICAgICAgZGVsZXRlQmF0Y2goaWRzKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ09LJykKICAgICAgICAgIHRoaXMuZmV0Y2hNZXNzYWdlKCkKICAgICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpCiAgICAgICAgfSkKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgbWVzc2FnZTogJ+WPlua2iOWIoOmZpCcKICAgICAgICB9KQogICAgICB9KQogICAgfSwKICAgIHJlbW92ZTogZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K+l6K6w5b2VLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHJlbW92ZShzY29wZS5yb3cuaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygnT0snKQogICAgICAgICAgdGhpcy5mZXRjaE1lc3NhZ2UoKQogICAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycikKICAgICAgICB9KQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgLy8g5omT5byA5Yqg6L295bGCCiAgICBvcGVuTG9hZGluZzogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRoaXMuJGxvYWRpbmcoewogICAgICAgIGxvY2s6IHRydWUsCiAgICAgICAgdGV4dDogJ+ato+WcqOWKoOi9veS4rX4nLAogICAgICAgIHNwaW5uZXI6ICdlbC1pY29uLWxvYWRpbmcnLAogICAgICAgIGJhY2tncm91bmQ6ICdyZ2JhKDAsIDAsIDAsIDAuNyknCiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlOiBmdW5jdGlvbih2YWwpIHsKICAgICAgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbiA9IHZhbAogICAgfSwKICAgIGhhbmRsZVNpemVDaGFuZ2U6IGZ1bmN0aW9uKHZhbCkgewogICAgICB0aGlzLnBhcmFtcy5wYWdlU2l6ZSA9IHZhbAogICAgICB0aGlzLmZldGNoTWVzc2FnZSgpCiAgICB9LAogICAgaGFuZGxlQ3VycmVudENoYW5nZTogZnVuY3Rpb24odmFsKSB7CiAgICAgIHRoaXMucGFyYW1zLnBhZ2VObyA9IHZhbAogICAgICB0aGlzLmZldGNoTWVzc2FnZSgpCiAgICB9LAogICAgZm9ybWF0VGltZTogZnVuY3Rpb24odGltZSkgewogICAgICByZXR1cm4gcGFyc2VUaW1lKHRpbWUpCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["message.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"message.vue","sourceRoot":"src/views/news","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 查询和其他操作 -->\n    <el-form v-show=\"showSearch\" ref=\"form\" :inline=\"true\" :model=\"params\" label-width=\"68px\">\n      <el-form-item label=\"用户名称\">\n        <el-input v-model=\"params.name\" style=\"width: 200px\" size=\"small\" placeholder=\"请输入昵称\" />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" icon=\"el-icon-search\" size=\"small\" @click=\"handleFind\">查找</el-button>\n        <el-button icon=\"el-icon-refresh\" size=\"small\" @click=\"resetQuery\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <el-row :gutter=\"10\" class=\"mb8\">\n      <el-col :span=\"1.5\">\n        <el-button\n          v-if=\"canDelBatch\"\n          :disabled=\"!multipleSelection.length\"\n          type=\"danger\"\n          icon=\"el-icon-delete\"\n          size=\"small\"\n          @click=\"handleDeleteBatch\"\n        >批量删除\n        </el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          v-if=\"canPassBatch\"\n          :disabled=\"!multipleSelection.length\"\n          type=\"success\"\n          icon=\"el-icon-circle-check\"\n          size=\"small\"\n          @click=\"handlePassBatch(null)\"\n        >批量通过\n        </el-button>\n      </el-col>\n      <right-toolbar :show-search.sync=\"showSearch\" @queryTable=\"fetchMessage\" />\n    </el-row>\n\n    <div style=\"margin-top: 5px\">\n      <el-table\n        border\n        :data=\"tableData\"\n        style=\"width: 100%\"\n        @selection-change=\"handleSelectionChange\"\n      >\n        <el-table-column\n          type=\"selection\"\n          align=\"center\"\n        />\n        <el-table-column prop=\"avatar\" align=\"center\" label=\"头像\">\n          <template slot-scope=\"scope\">\n            <el-avatar shape=\"square\" :size=\"50\" :src=\"scope.row.avatar\" />\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"nickname\" align=\"center\" width=\"180\" label=\"昵称\" />\n        <el-table-column prop=\"content\" align=\"center\" width=\"180\" label=\"内容\" />\n        <el-table-column prop=\"ipAddress\" align=\"center\" width=\"150\" label=\"ip地址\" />\n        <el-table-column prop=\"ipSource\" align=\"center\" width=\"160\" label=\"ip来源\" />\n        <el-table-column prop=\"status\" align=\"center\" label=\"状态\">\n          <template slot-scope=\"scope\">\n            <el-tag v-if=\"scope.row.status === 1\" type=\"success\">正常</el-tag>\n            <el-tag v-else type=\"info\">审核中</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"createTime\" width=\"160\" align=\"center\" label=\"留言时间\">\n          <template slot-scope=\"scope\">\n            <span>{{ formatTime(scope.row.createTime) }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column align=\"center\" label=\"操作\" width=\"160\" class-name=\"small-padding fixed-width\">\n          <template slot-scope=\"scope\">\n            <el-button v-if=\"canPassBatch&&!scope.row.status\" type=\"primary\" size=\"mini\" @click=\"handlePassBatch(scope)\">通过</el-button>\n            <el-button v-if=\"canDel\" size=\"mini\" type=\"danger\" @click=\"remove(scope)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n\n    <!--分页区域-->\n    <div class=\"pagination-container\" style=\"float: right;margin-bottom: 1.25rem;margin-top: 1.25rem;\">\n      <el-pagination\n        background\n        :current-page=\"params.pageNo\"\n        :page-size=\"params.pageSize\"\n        :page-sizes=\"[10, 20, 30]\"\n        layout=\"total, sizes,prev, pager, next,jumper\"\n        :total=\"total\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n      />\n    </div>\n  </div>\n</template>\n<script>\nimport { fetchMessage, passBatch, deleteBatch, remove } from '@/api/message'\nimport { parseTime } from '@/utils'\nimport { mapGetters } from 'vuex'\nimport { hasAuth } from '@/utils/auth'\n\nexport default {\n  data() {\n    return {\n      tableData: [],\n      multipleSelection: [],\n      // 加载层信息\n      loading: [],\n      total: 0,\n      showSearch: true,\n      params: {\n        name: null,\n        pageNo: 1,\n        pageSize: 10\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'pres'\n    ]),\n    canDel: function() {\n      return hasAuth(this.pres, '/system/message/remove')\n    },\n    canDelBatch: function() {\n      return hasAuth(this.pres, '/system/message/deleteBatch')\n    },\n    canPassBatch: function() {\n      return hasAuth(this.pres, '/system/message/passBatch')\n    }\n  },\n  created: function() {\n    this.openLoading()\n    this.fetchMessage()\n  },\n  methods: {\n    fetchMessage: function() {\n      fetchMessage(this.params).then(res => {\n        this.tableData = res.data.records\n        this.total = res.data.total\n        this.loading.close()\n      }).catch(err => {\n        console.log(err)\n      })\n    },\n    resetQuery: function() {\n      this.params.name = null\n      this.params.pageNo = 1\n      this.fetchMessage()\n    },\n    handleFind: function() {\n      this.params.pageNo = 1\n      this.fetchMessage()\n    },\n    handlePassBatch: function(scope) {\n      const ids = []\n      if (scope != null) {\n        ids.push(scope.row.id)\n      } else {\n        this.multipleSelection.forEach(item => {\n          ids.push(item.id)\n        })\n      }\n      passBatch(ids).then(res => {\n        this.$message.success('OK')\n        this.fetchMessage()\n      }).catch(err => {\n        console.error(err)\n      })\n    },\n    handleDeleteBatch: function() {\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        const ids = []\n        this.multipleSelection.forEach(item => {\n          ids.push(item.id)\n        })\n        deleteBatch(ids).then(res => {\n          this.$message.success('OK')\n          this.fetchMessage()\n        }).catch(err => {\n          console.error(err)\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '取消删除'\n        })\n      })\n    },\n    remove: function(scope) {\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        remove(scope.row.id).then(res => {\n          this.$message.success('OK')\n          this.fetchMessage()\n        }).catch(err => {\n          console.error(err)\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '取消删除'\n        })\n      })\n    },\n    // 打开加载层\n    openLoading: function() {\n      this.loading = this.$loading({\n        lock: true,\n        text: '正在加载中~',\n        spinner: 'el-icon-loading',\n        background: 'rgba(0, 0, 0, 0.7)'\n      })\n    },\n    handleSelectionChange: function(val) {\n      this.multipleSelection = val\n    },\n    handleSizeChange: function(val) {\n      this.params.pageSize = val\n      this.fetchMessage()\n    },\n    handleCurrentChange: function(val) {\n      this.params.pageNo = val\n      this.fetchMessage()\n    },\n    formatTime: function(time) {\n      return parseTime(time)\n    }\n  }\n}\n</script>\n"]}]}